<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Applicant Form</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='applicant.css') }}"
    />
    <style>
      .popup-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
      }

      .popup {
        background: white;
        padding: 20px;
        border-radius: 10px;
        width: 300px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .popup button {
        margin: 10px;
        padding: 8px 15px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }

      .ok-btn {
        background: green;
        color: white;
      }

      .cancel-btn {
        background: red;
        color: white;
      }
    </style>
  </head>
  <body>
    <form id="applicantForm" action="" method="POST" enctype="multipart/form-data">
      <div class="details">
        <div>
          <label for="name">Full Name: </label><br />
          <input type="text" placeholder="Enter your full name" name="name" id="name" />
        </div>
        <br />

        <div>
          <label for="dob">Date of Birth: </label><br />
          <input type="date" id="dob" name="dob" />
        </div>
        <br />

        <div>
          <label for="email">Email : </label><br />
          <input type="email" placeholder="Enter your email" name="email" id="email" />
        </div>
        <br />

        <div>
          <label for="qualification">Your qualifications : </label><br />
          <input type="text" placeholder="Enter your qualifications" name="qualification" id="qualification" />
        </div>
        <br />

        <div>
          <label for="mobile">Mobile No. : </label><br />
          <input type="number" name="mobileNo" id="mobile" />
        </div>
        <br />

        <div>
          <label for="resumeFile">Submit Your Resume: </label>
          <input type="file" name="file" id="resumeFile" />
        </div>
        <br />

        <div>
          <button type="button" onclick="handleSubmit()">Submit</button>
          <div class="back-link">
            <a href="{{ url_for('dashboard') }}">&#8592; Back to dashboard</a>
          </div>
        </div>
      </div>
    </form>

    <div class="popup-overlay" id="popupOverlay">
      <div class="popup" id="popupBox">
        <h3 id="popupTitle">Message</h3>
        <p id="popupMessage">...</p>
        <button class="ok-btn" id="popupOkBtn">OK</button>
        <button class="cancel-btn" id="popupCancelBtn" onclick="closePopup()">Cancel</button>
      </div>
    </div>

    <script>
      let popup = document.getElementById("popupOverlay");
      let popupTitle = document.getElementById("popupTitle");
      let popupMessage = document.getElementById("popupMessage");
      let popupOkBtn = document.getElementById("popupOkBtn");
      let popupCancelBtn = document.getElementById("popupCancelBtn");

      function validateForm() {
        let name = document.getElementById("name").value.trim();
        let email = document.getElementById("email").value.trim();
        let mobile = document.getElementById("mobile").value.trim();
        let dob = document.getElementById("dob").value.trim();
        let resume = document.getElementById("resumeFile");
        let qualification = document.getElementById("qualification").value.trim();

        if (
          name &&
          email &&
          mobile &&
          dob &&
          qualification &&
          resume.files.length > 0
        ) {
          return true;
        }
        return false;
      }

      function handleSubmit() {
        popup.style.display = "flex";
        if (validateForm()) {
          popupTitle.innerText = "Are you sure?";
          popupMessage.innerText = "Do you want to submit the form?";
          popupOkBtn.innerText = "OK";
          popupCancelBtn.style.display = "inline-block";

          popupOkBtn.onclick = submitForm;
        } else {
          popupTitle.innerText = "Incomplete Form";
          popupMessage.innerText = "⚠️ Please fill all fields before submitting.";
          popupOkBtn.innerText = "OK";
          popupCancelBtn.style.display = "none";

          popupOkBtn.onclick = closePopup;
        }
      }

      function closePopup() {
        popup.style.display = "none";
      }

      function submitForm() {
        popupTitle.innerText = "Successfully Submitted!";
        popupMessage.innerText = "Your application has been recorded.";
        popupOkBtn.innerText = "Go to Dashboard";
        popupCancelBtn.style.display = "none";

        popupOkBtn.onclick = goToDashboard;
      }

      function goToDashboard() {
        document.getElementById("applicantForm").submit();
        window.location.href = "{{ url_for('dashboard') }}";
      }
    </script>
  </body>
</html>
